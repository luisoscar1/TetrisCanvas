<!-- 
profe utilize su coddigo para no complicarme

-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        Tetris
    </title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.10.0/p5.min.js"></script>
    <style type="text/css">
        body {
            background-color: gray;
        }

        canvas {
            background-color: white;
        }
    </style>
</head>

<body>

    <!-- <canvas id="myCanvas" width="600" height="500"></canvas>
 -->
    <script type="text/javascript">
        /* const myCanvas = document.getElementById("myCanvas");
        const ctx = myCanvas.getContext("2d"); */

        var direction = '';
        const tama√±oBloque = 30;
        const bordeAncho = 10;
        const bordeAlto = 20;
        const margenTablero = 20;
        function setup() {
            createCanvas(900, 600)
            tablero = new Tablero()
            mapeo()
            tetrimino = new Tetrimino()
            
            resizeCanvas(tablero.ancho + margenTablero, tablero.alto + margenTablero)
        }

        function draw() {
            tablero.dibujar()
            tetrimino.dibujar()
            update()
        }

        class Tablero {
            constructor() {
                this.columnas = 10
                this.filas = 20
                this.lado_celda = 25
                this.ancho = this.columnas * this.lado_celda
                this.alto = this.filas * this.lado_celda
                this.posicion = createVector(5, 2)
            }


            coordenada(x, y) {
                return createVector(x, y).mult(this.lado_celda).add(this.posicion)
            }

            dibujar() {
                for (let columnas = 0; columnas < this.columnas; columnas++) {
                    for (let filas = 0; filas < this.filas; filas++) {
                        let c = this.coordenada(columnas, filas)
                        rect(c.x, c.y, this.lado_celda)
                    }
                }
            }
        }

        function mapeo() {
            tetriminos = {
                "Z": {
                    color: "blue",
                    mapa: [
                        createVector()
                    ]

                }
            }
        }

        class Tetrimino {
            constructor(nombre = "Z") {
                this.nombre = nombre
                let tetriminoBase = tetriminos[nombre]
                this.color = tetriminos.color
                this.mapa = []
                for (const tetri of tetriminoBase.mapa) {
                    this.mapa.push(tetri.copy())
                }
                this.posicion = createVector(0, 0)
            }

            get mapaTablero(){
                let retorno = []
                for (const tetri of this.mapa) {
                    let copiar = tetri.copy().add(this.posicion)
                   retorno.push(tablero.coordenada(copiar.x, copiar.y))
                }
                return retorno
            }

            dibujar() {
                push()
                fill("red")
                for (const tetri of this.mapaTablero) {
                    rect(tetri.x, tetri.y, tablero.lado_celda)
                }
                pop()
            }
        }

        document.addEventListener('keydown', function (e) {
            switch (e.key) {
                case 'w':
                    direction = 'up';
                    break;
                case 's':
                    direction = 'down';
                    break;
                case 'a':
                    direction = 'left';
                    break;
                case 'd':
                    direction = 'right';
                    break;
            }
        });


        function update() {
            switch (direction) {
                case 'up':
                    tetrimino.posicion.y--;
                    break;
                case 'down':
                    tetrimino.posicion.y++;
                    break;
                case 'right':
                    tetrimino.posicion.x++;
                    break;
                case 'left':
                    tetrimino.posicion.x--;
                    break;
            }
            direction = '';
        }

    </script>
</body>

</html>